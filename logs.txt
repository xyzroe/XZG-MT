xzg-multi-tool@0.1.0 build:bridge
> npm --prefix bridge run build:pkg:all
> bridge@0.1.2 build:pkg:all
> npm run build:pkg:mac && npm run build:pkg:linux && npm run build:pkg:win && npm run build:legacy:win7 && ls -l ./dist/mac && ls -l ./dist/linux && ls -l ./dist/win && ls -l ./dist/win-legacy
> bridge@0.1.2 build:pkg:mac
> npm run copy-web && rm -rf dist/mac && mkdir -p dist/mac && pkg . --targets node18-macos-x64 --output dist/mac/XZG-MT-macos-x64 && pkg . --targets node18-macos-arm64 --output dist/mac/XZG-MT-macos-arm64
> bridge@0.1.2 copy-web
> node scripts/copy-web.js
Copied web files from /Users/runner/work/XZG-MT/XZG-MT/web-page/dist to /Users/runner/work/XZG-MT/XZG-MT/bridge/web
> pkg@5.8.1
> Fetching base Node.js binaries to PKG_CACHE_PATH
> Warning Non-javascript file is specified in 'scripts'.
Pkg will probably fail to parse. Specify *.js in glob.
/Users/runner/work/XZG-MT/XZG-MT/node_modules/@serialport/binding-mock/dist/index-esm.mjs
> Warning Non-javascript file is specified in 'scripts'.
Pkg will probably fail to parse. Specify *.js in glob.
/Users/runner/work/XZG-MT/XZG-MT/node_modules/@serialport/bindings-interface/dist/index-esm.mjs
> Warning Cannot resolve 'path.join(process.cwd(), test)'
/Users/runner/work/XZG-MT/XZG-MT/node_modules/node-gyp-build/build-test.js
Dynamic require may fail at run time, because the requested file
is unknown at compilation time and not included into executable.
Use a string literal as an argument for 'require', or leave it
as is and specify the resolved file name in 'scripts' option.
> Warning Failed to make bytecode node18-x64 for file /snapshot/XZG-MT/node_modules/@serialport/binding-mock/dist/index-esm.mjs
> pkg@5.8.1
> Fetching base Node.js binaries to PKG_CACHE_PATH
> Warning Non-javascript file is specified in 'scripts'.
Pkg will probably fail to parse. Specify *.js in glob.
/Users/runner/work/XZG-MT/XZG-MT/node_modules/@serialport/binding-mock/dist/index-esm.mjs
> Warning Non-javascript file is specified in 'scripts'.
Pkg will probably fail to parse. Specify *.js in glob.
/Users/runner/work/XZG-MT/XZG-MT/node_modules/@serialport/bindings-interface/dist/index-esm.mjs
> Warning Cannot resolve 'path.join(process.cwd(), test)'
/Users/runner/work/XZG-MT/XZG-MT/node_modules/node-gyp-build/build-test.js
Dynamic require may fail at run time, because the requested file
is unknown at compilation time and not included into executable.
Use a string literal as an argument for 'require', or leave it
as is and specify the resolved file name in 'scripts' option.
> Warning Failed to make bytecode node18-arm64 for file /snapshot/XZG-MT/node_modules/@serialport/binding-mock/dist/index-esm.mjs
> bridge@0.1.2 build:pkg:linux
> npm run copy-web && rm -rf dist/linux && mkdir -p dist/linux && pkg . --targets node18-linux-x64 --output dist/linux/XZG-MT-linux-x64 && pkg . --targets node18-linux-arm64 --output dist/linux/XZG-MT-linux-arm64
> bridge@0.1.2 copy-web
> node scripts/copy-web.js
Copied web files from /Users/runner/work/XZG-MT/XZG-MT/web-page/dist to /Users/runner/work/XZG-MT/XZG-MT/bridge/web
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-inter-byte-timeout/dist/index.js is added to queue.
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-packet-length/dist/index.js is added to queue.
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-readline/dist/index.js is added to queue.
> [debug] Content of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-delimiter/package.json is added to queue. It was required from /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-readline/dist/index.js
> [debug] Bytecode of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-delimiter/dist/index.js is added to queue. It was required from /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-readline/dist/index.js
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-ready/dist/index.js is added to queue.
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-regex/dist/index.js is added to queue.
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-slip-encoder/dist/decoder.js is added to queue.
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-slip-encoder/dist/encoder.js is added to queue.
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-slip-encoder/dist/index.js is added to queue.
> [debug] Bytecode of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-slip-encoder/dist/decoder.js is added to queue. It was required from /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-slip-encoder/dist/index.js
> [debug] Bytecode of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-slip-encoder/dist/encoder.js is added to queue. It was required from /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-slip-encoder/dist/index.js
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-spacepacket/dist/index.js is added to queue.
> [debug] Bytecode of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-spacepacket/dist/utils.js is added to queue. It was required from /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-spacepacket/dist/index.js
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/parser-spacepacket/dist/utils.js is added to queue.
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/stream/dist/index.js is added to queue.
> [debug] Content of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/debug/package.json is added to queue. It was required from /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/stream/dist/index.js
> [debug] Bytecode of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/debug/src/index.js is added to queue. It was required from /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/@serialport/stream/dist/index.js
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/node-gyp-build/bin.js is added to queue.
> [debug] Cannot find module 'node-gyp/package.json' from '/Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/node-gyp-build'  in /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/node-gyp-build/bin.js
> [debug] Cannot find module 'node-gyp/package.json' from '/Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/node-gyp-build'  in /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/node-gyp-build/bin.js
> [debug] Stat info of /Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/node-gyp-build/build-test.js is added to queue.
> Warning Cannot resolve 'path.join(process.cwd(), test)'
/Users/runner/work/XZG-MT/XZG-MT/bridge/legacy/node_modules/node-gyp-build/build-test.js
Dynamic require may fail at run time, because the requested file
is unknown at compilation time and not included into executable.
Use a string literal as an argument for 'require', or leave it
as is and specify the resolved file name in 'scripts' option.
> [debug] Cannot resolve 'path.join(process.cwd(), 'package.json')'
=== strings search for web/ inside exe ===
"build:pkg:win7": "set -e && npm run prep && rm -rf ../dist/win-legacy && mkdir -p ../dist/win-legacy && cp -R ../web ./web 2>/dev/null || true && echo '=== web tree (legacy/web) ===' && ls -R ./web || true && echo 'pkg version:' && npx pkg --version || true && echo '=== running pkg (debug) ===' && npx pkg . --targets node12-win-x64 --output ../dist/win-legacy/XZG-MT-win7-x64.exe --debug 2>&1 | tee /tmp/pkg.log || true && echo '=== pkg.log (head 300) ===' && head -n 300 /tmp/pkg.log || true && echo '=== strings search for web/ inside exe ===' && (strings ../dist/win-legacy/XZG-MT-win7-x64.exe | grep -a \"web/\" || true) && echo '=== full ls dist/win-legacy ===' && ls -R ../dist/win-legacy || true"
"web/**/*"
=== full ls dist/win-legacy ===
XZG-MT-win7-x64.exe
total 64368
-rw-r--r--  1 runner  staff  32947097 Aug 29 13:42 XZG-MT-win7-x64.exe
total 217136
-rwxr-xr-x  1 runner  staff  53856176 Aug 29 13:41 XZG-MT-macos-arm64
-rwxr-xr-x  1 runner  staff  57312832 Aug 29 13:41 XZG-MT-macos-x64
total 206152
-rwxr-xr-x  1 runner  staff  52002503 Aug 29 13:42 XZG-MT-linux-arm64
-rwxr-xr-x  1 runner  staff  53479463 Aug 29 13:42 XZG-MT-linux-x64
total 87728
-rw-r--r--  1 runner  staff  44852855 Aug 29 13:42 XZG-MT-win-x64.exe
total 64368
-rw-r--r--  1 runner  staff  32947097 Aug 29 13:42 XZG-MT-win7-x64.exe